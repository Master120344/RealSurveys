<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surveys</title>
    <link rel="stylesheet" href="css/surveys.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>
    <script type="module">
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getDatabase, ref, get } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyA7GP-4bnijUNXGBti2nCOJF9iwusuL7c4",
            authDomain: "real-surveys.firebaseapp.com",
            databaseURL: "https://real-surveys-default-rtdb.firebaseio.com",
            projectId: "real-surveys",
            storageBucket: "real-surveys.appspot.com",
            messagingSenderId: "1024139519354",
            appId: "1:1024139519354:web:a0b11a5a0560ab02ee22c3"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Redirect to login page if user is not authenticated
        onAuthStateChanged(auth, (user) => {
            if (!user) {
                window.location.href = 'login.html';
            } else {
                // Load user data and update balance
                const userId = user.uid;
                const userRef = ref(database, 'users/' + userId);
                get(userRef).then((snapshot) => {
                    if (snapshot.exists()) {
                        const userData = snapshot.val();
                        document.getElementById('current-balance').innerText = `$${userData.balance.toFixed(2)}`;
                    } else {
                        console.error("No user data found.");
                    }
                }).catch((error) => {
                    console.error("Error fetching user data: ", error);
                });
            }
        });
    </script>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="surveys.html">Surveys</a></li>
                    <li><a href="#">Giveaways</a></li>
                    <li><a href="logout.html">Log Out</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div class="hero">
        <h2>Available Surveys</h2>
        <p>Your current balance: <span id="current-balance">$20.00</span></p>
    </div>
    <div class="surveys-container">
        <!-- Example Survey Card -->
        <div class="survey-card">
            <img src="images/amazon.jpg" alt="Amazon Survey" class="survey-image">
            <h3>Amazon Survey</h3>
            <p>Earn $7 for completing this survey.</p>
            <a href="amazon_survey.html" class="survey-link">Take Survey</a>
        </div>
        <!-- Repeat for each survey -->
        <!-- Example of another survey -->
        <div class="survey-card">
            <img src="images/apple.jpg" alt="Apple Survey" class="survey-image">
            <h3>Apple Survey</h3>
            <p>Earn $6 for completing this survey.</p>
            <a href="apple_survey.html" class="survey-link">Take Survey</a>
        </div>
        <!-- Add more survey cards as needed -->
    </div>
    <footer>
        <p>&copy; 2024 Your Survey Company. All rights reserved.</p>
    </footer>
    <script src="js/surveys.js"></script>
</body>
</html>
